---
layout: post
title: Быстрый старт в научные вычисления
date: 2018-02-17 00:00:00
categories:
  - Science
description:
image: /images/posts/180217_scientifictools/card.png
image-sm: /images/posts/180217_scientifictools/card-sm.png
---

## Введение. Для кого и зачем.

Этот пост написан, прежде всего, для моих студентов 3го курса ФУПМ МФТИ с целью предоставить всем равные возможности для изучения курса по методам оптимизации в весеннем семестре, так как он предполагает интенсивную практическую работу с языком Python. В то же время, данный материал может быть полезен многим студентам младших курсов, желающих почувствовать себя властелинами вычислительной математики легко и играючи. Буду невероятно [рад](https://t.me/bratishk) дополнениям, исправлениям, хинтам и замечаниям.

Среди корыстных интересов я бы выделил желание систематизировать накопленный опыт и материалы, а так же интерес проверить срок годности данного поста, так как computer science развивается (и еще долго будет развиваться) такими темпами, что большинство практических советов и лайфхаков в этой области имеют весьма существенный шанс стать безбожно устарелыми уже через год (true story, покажите мне мануал по TensorFlow годовой давности - код из него с высокой вероятностью не скомпилируется). Это, кстати, весьма странная ситуация - вычислительные тулзы стали настолько удобными и приятными, что возникает огромное желание в них закопаться, в то время как очевидна необходимость изучать фундаментальные разделы этой науки - они с бОльшей вероятностью останутся актуальны к тому моменту, как студент получит образование. Ладно, я ушел в оффтоп, погнали!

## Как делать научные вычисления
Для начала необходимо установить среду, в которой Вы проведете самые лучшие и счастливые годы Вашей жизни. Конечно, мы говорим о [Jupyter Notebook](http://jupyter.org/). Вообще говоря, Jupyter - это мощнейший инструмент кроссплатформенной разработки, поддерживающий более 40 языков программирования, в числе которых Python, R и даже [Matlab](https://github.com/Calysto/matlab_kernel)! Тем не менее, языком, на котором фокусируется данное повествование, будет именно Python 3.

### Jupyter

Нужно [тыкнуть](https://www.anaconda.com/download/) на страницу скачивания и выбрать третий Python.

![](/images/posts/180217_scientifictools/anaconda.png)

Итак, Вы установили Python, Jupyter и еще много всякого. Как же запускать jupyter notebook без боли в произвольной папке?

#### Как быстро запускать jupyter notebook
Достаточно создать исполняемый скрипт, запускаемый двойным нажатием со следующим содержанием:
```bash
jupyter notebook --notebook-dir='C:\\Users\\bratishka\\Desired_folder'
```
В Windows это будет файл с расширением `.bat`, в Linux `.sh`, который можно редактировать с помощью любого текстового редактора (например, моего любимого [sublime](https://www.sublimetext.com/)). Обратите внимание на то, что бэкслэши в примере двойные - это сделано, чтобы избежать проблем с кодировками (иногда, например, `\U` в адресе папки может сильно подпортить Вам жизнь:) )

#### Облачные возможности jupyter



##### Запуск тетрадок онлайн
Прежде всего, существует официальный сервис [try.jupyter.org](https://try.jupyter.org). Туда можно загрузить и скомпилировать несложный ноутбук. Следует быть аккуратным, ведь виртуальный сервер, который Вам выделяется при запуске ~~кекается~~ падает через 10 минут бездействия. Данная опция подходит прежде всего в том случае, когда Вам нужно быстро собрать что то на коленке (или даже в дороге!) или возникли неожиданные проблемы с компьютером.

Существуют так же более солидные сервисы для работы онлайн с ноутбуками, предоставляющие облачные сервера и возможность совместной работы над проектами.

*   [notebooks.azure.com](https://notebooks.azure.com/)
*   [cocalc.com](https://cocalc.com/)

##### Рендеринг готовых тетрадок и презентаций онлайн
Сервис [nbviewer.jupyter.org](https://nbviewer.jupyter.org/) умеет отображать ноутбуки загруженные в Ваш личный аккаунт на гитхабе. Пример тетрадки можно найти [здесь](https://nbviewer.jupyter.org/github/merkulovdaniil/mipt_optimization/blob/master/lectures/10.%20Numerical%20methods/10_numerical_methods.ipynb). Так же, рендерятся презентации ([пример](https://nbviewer.jupyter.org/format/slides/github/oseledets/nla2017/blob/master/lectures/lecture-4.ipynb#/30)), для их запуска нужно нажать значок подарка:
![](/images/posts/180217_scientifictools/nbviewer_pres.gif)

##### Расшарить свой проект с возможностью запуска кода

Вершиной повторяемых вычислений на сегодняшний день является возможность выложить весь свой проект в интернет и сделать его запускаемо-кликабельным с ядром, которое работает где то в облаке. Это гарантирует повторяемость полученных Вами результатов, снимая их зависимость от железа и установленных на Вашей вычислительной станции библиотек. Представьте, что Вам не нужно больше скачивать необходимое ПО и пакеты, Вам нужно нажать всего одну кнопку. Эта штука называется [binder](https://mybinder.org/):

![](/images/posts/180217_scientifictools/binder.gif)

Binder гарантирует Вам 1Гб оперативной памяти (может быть и больше, но ограничение сверху - 4Гб), относительно небольшие вычислительные ресурсы, а так же запрет внешних сетевых подключений. Кроме того, сервер так же выключается после 10 минут бездействия (открытое окно в браузере считается *не* бездействием). На [сайте](https://mybinder.readthedocs.io/en/latest/) хорошая документация (для того, чтобы выложить интерактивную запускаемую тетрадку - даже мануала читать не нужно. Выложить ее на гитхаб, указать ссылку и получить рабочую кнопку) . 

Впрочем, если Вы занимаетесь вычислительно интенсивной работой (например, [DEEP MACHINE LEARNING](https://coub.com/view/1069gn)), binder Вам не подойдет, поскольку его вычислительных мощностей часто катастрофически не хватает для современных реальных задач (нас спасет docker - см. ниже). В то же время, никто не мешает оформить там проект по вычматам или лабы и выложить у себя на гитхабе. Вот, например, [проект](https://github.com/minrk/ligo-binder) с анализом данных, полученных с детектора гравитационных волн LIGO.

#### Библиотеки python

Большая часть полезности языка программирования реализуется через крутые библиотеки, написанные для него. Здесь я бы хотел осветить некоторые наиболее полезные, на мой взгляд, библиотеки, которые могут пригодиться будущему ученому. По большому счету, каждой из них можно посвятить отдельный пост, поэтому я вкратце опишу их предназначение, ссылку на официальный мануал и, быть может, еще что нибудь.

##### numpy

Библиотека для эффективной работы с многомерными массивами. Преобразование Фурье, матричные преобразования, разложения - туда же. Значительная часть функций библиотеки реализована на C, засчет чего библиотека работает достаточно эффективно. Tutorial по [ссылке](https://docs.scipy.org/doc/numpy-dev/user/quickstart.html), однако данная библиотека является стандартом де-факто на сегодняшний день и очень тяжело придумать проблему, которую в numpy нельзя решить путем не очень активного гугления.

##### matplotlib

Библиотека для построения графиков. Здесь алгоритм простой: заходите на [сайт](https://matplotlib.org/gallery/index.html), тыкаете на пример, который больше всего похож на тот, что у Вас в голове, копипасите код и доводите до блеска. Приведу лишь парочку трюков:

*   ```python
    # Если вставить вот такую строчку перед рисованием графиков, они будут отрисовываться в стиле комиксов
    import matplotlib.pyplot as plt
    plt.xkcd()
    ```
    ![](/images/posts/180217_scientifictools/xkcd.png)

*   ```python
    # А если вставить такую строчку перед рисованием графиков, они будут отрисовываться в другом стиле. 
    import seaborn
    ```
    ![](/images/posts/180217_scientifictools/seaborn.png)

    Вообще говоря, seaborn - это отдельная библиотека, которая работает в тесной связке с matplotlib, но имеет много своих [фишечек](https://seaborn.pydata.org/examples/index.html).

*    Особенно хотелось бы выделить интерактивный режим работы с графиками в jupyter notebook. Если в начале ячейки прописать:

    ```python
    %matplotlib notebook
    ```

    То будут доступны прикольные штуки, типа интерактивного зума в выделенное окно, изменение размера фигуры и прочее:
    ![](/images/posts/180217_scientifictools/matplotlib_notebook.gif)

    Из минусов: рендеринг очень медленный (особенно, если график "тяжелый"), иногда глючит (особенно, если менять бекенд для отрисовки графиков в работающем ядре - т.е. если сначала у вас было `%matplotlib inline`, то после замены на `%matplotlib notebook` может кекнуться - решается перезапуском Kernel). Для интерактивных графиков можно так же использовать библиотеки [bokeh](https://bokeh.pydata.org/en/latest/docs/gallery.html) ([демка](https://demo.bokehplots.com/apps/movies), иллюстрирующая работу bokeh на IMDB) и [plot.ly](https://plot.ly/) (если разобраться в документации, ее вполне себе можно использовать бесплатно, вот средненький [пример](http://nbviewer.jupyter.org/github/merkulovdaniil/mipt_optimization/blob/master/lectures/1.%20Introduction/1_introduction.ipynb))
##### pandas

Библиотека для работы с массивами данных. Позволяет легко расправляться с датасетами, представленных в виде таблиц (`.csv`, `.txt`  и прочие). Идеально подходит, если у Вас есть табличка с данными (например, Excel табличка с лабы) и Вам нужно быстро понять, например, среднее значение по какому нибудь из столбцов или заменить все значения в таблице меньше 3 на нули. Десятиминутное [введение](http://pandas.pydata.org/pandas-docs/stable/10min.html) есть на официальном сайте.

##### scikitlearn

Библиотека для машинного обучения. Каждый уважающий себя [MACHINE_LEARNER](https://coub.com/view/1069gn) проходил через эту библиотеку. Здесь есть очень много вкусностей - эффективная реализация огромного количества базовых алгоритмов, удобная загрузка классических датасетов, отличная [документация](http://scikit-learn.org/stable/tutorial/basic/tutorial.html) и ссылки на статьи, на основе которых реализованы алгоритмы. Совместима с numpy, matplotlib, scipy.

##### sympy

Библиотека символьных вычислений. Эта штука понимает, что $x$

##### cython

##### tensorflow + keras

##### pytorch

##### прочее

Не забывать:

```python
import this
```

Быстрое и честное умножение матриц (в т.ч. векторов):

```python
A @ B
```

















## Как оформлять научные вычисления



















## Осваиваем язык.

Шикарнейший [курс](https://stepik.org/course/67/syllabus) по Python.

## Расширяем возможности или библиотеки для научных вычислений.

Топ [курс](https://stepik.org/course/3356/syllabus) от яндекса.

## Полезные советы и всякие плюшки.

### matplotlib notebook

### nbconvert

### презентации в jupyter; RISE

### Запуск ядра jupyter на стороннем сервере

### Курс по NLA

### Docker

### Detexify

### Markdown

### Минимальный набор необходимых консольных команд
UNIX: cd ls htop watch nvidia-smi

### 

[TOC]

